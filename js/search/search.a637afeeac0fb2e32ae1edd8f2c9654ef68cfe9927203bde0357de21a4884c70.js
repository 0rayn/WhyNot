(()=>{var l=20;(function(){let i=new FlexSearch.Document({document:{id:"id",index:["title","tags","content","date"],store:["title","summary","date","permalink"]},tokenize:"forward"});function m(e){let t=document.querySelector("template").content,c=document.createDocumentFragment(),o=document.querySelector(".search-results");o.textContent="";for(let s in e){let n=e[s],r=t.cloneNode(!0),d=r.querySelector("a"),y=r.querySelector("time"),q=r.querySelector(".content");d.innerHTML=n.title,d.href=n.permalink,y.innerText=n.date,q.innerHTML=n.summary,c.appendChild(r)}o.appendChild(c)}function a(e){let t=e||document.querySelector(".search-text").value.trim(),c=i.search({query:t,enrich:!0,limit:l}),o={};c.forEach(function(s){s.result.forEach(function(n){o[n.doc.permalink]=n.doc})}),m(o)}function h(e){e.addEventListener("submit",function(t){t.preventDefault(),a()}),e.addEventListener("input",function(){a()}),document.querySelector(".search-loading").classList.add("hidden"),document.querySelector(".search-bar").classList.remove("hidden"),document.querySelector(".search-text").focus()}function f(e){fetch(searchindex).then(function(t){return t.json()}).then(function(t){t.forEach(function(c){i.add(c)})}).then(e)}let u=document.querySelector(".search-form");u&&(f(function(){let e=new URLSearchParams(window.location.search).get("q");document.querySelector(".search-text").value=e||"",a(e)}),h(u))})();})();
