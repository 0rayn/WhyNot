(()=>{var m="/WhyNot/",h=20;(function(){let i=new FlexSearch.Document({document:{id:"id",index:["title","tags","content","date"],store:["title","summary","date","permalink"]},tokenize:"forward"});function f(e){let t=document.querySelector("template").content,n=document.createDocumentFragment(),c=document.querySelector(".search-results");c.textContent="";for(let a in e){let o=e[a],r=t.cloneNode(!0),d=r.querySelector("a"),p=r.querySelector("time"),S=r.querySelector(".content");d.innerHTML=o.title,d.href=o.permalink,p.innerText=o.date,S.innerHTML=o.summary,n.appendChild(r)}c.appendChild(n)}function s(e){let t=e||document.querySelector(".search-text").value.trim(),n=i.search({query:t,enrich:!0,limit:h}),c={};n.forEach(function(a){a.result.forEach(function(o){c[o.doc.permalink]=o.doc})}),f(c)}function y(e){e.addEventListener("submit",function(t){t.preventDefault(),s()}),e.addEventListener("input",function(){s()}),document.querySelector(".search-loading").classList.add("hidden"),document.querySelector(".search-bar").classList.remove("hidden"),document.querySelector(".search-text").focus()}function q(e){let t=m+"searchindex.json";document.querySelector(".search-loading").classList.remove("hidden"),console.log("Fetching from:",t),fetch(t).then(function(n){return n.json()}).then(function(n){n.forEach(function(c){i.add(c)})}).then(e)}let u=document.querySelector(".search-form");u&&(q(function(){let e=new URLSearchParams(window.location.search).get("q");document.querySelector(".search-text").value=e||"",s(e)}),y(u))})();})();
